<!doctype html>
<html lang="zh"> 
 <head> 
  <meta charset="utf-8"> 
  <meta name="keywords" content="Git对非ASCII文件名的Octal Escape处理说明 - 架构教练,架构师个人成长教练,个人成长,组织成长,个人与组织成长顾问, architecture, book author, thinker, fighter, 架构, 思考, 技术, 武术, 哲学"> 
  <meta name="description" content="Git对非ASCII文件名的Octal Escape处理说明 - 扶墙老师说，王福强的个人博客， 一个架构士的思考与沉淀"> 
  <meta name="author" content="王福强"> 
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> 
  <title>Git对非ASCII文件名的Octal Escape处理说明 -王福强的个人博客：一个架构士的思考与沉淀</title> 
  <link rel="shortcut icon" href="/favicon.ico"> 
  <style type="text/css">code{white-space: pre;}</style> 
  <script src="https://unpkg.com/htmx.org@1.9.5"></script> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"> 
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> 
  <script type="text/javascript" src="/js/watermark.js"></script> <!-- Bootstrap core CSS --> 
  <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"> <!-- Custom fonts for this template --> 
  <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css"> <!-- Custom styles for this template --> 
  <link href="/css/freelancer.css" rel="stylesheet"> 
  <style type="text/css">
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      text-align: left;
      position: relative;
      -webkit-font-smoothing: antialiased;
    }
    

    h1{
      margin-top: 3rem;
    }
  </style> 
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "headline": "Git对非ASCII文件名的Octal Escape处理说明",
      "image": [
        "https://afoo.me/images/fb_subscribe.jpg"
       ],
      "datePublished": "0000-00-00",
      "author": [{
          "@type": "Person",
          "name": "王福强",
          "url": "https://afoo.me"
        }]
    }
  </script> 
 </head> 
 <body id="page-top"> <!-- Navigation --> 
  <nav class="navbar navbar-expand-lg bg-secondary fixed-top text-uppercase" id="mainNav"> 
   <div class="container"> <a class="navbar-brand js-scroll-trigger" href="/"> <img src="/images/profile.jpeg" alt="" style="display: inline; border-radius: 50%; height: 50px;">王福强的个人博客 </a> <button class="navbar-toggler navbar-toggler-right text-uppercase bg-primary text-white rounded" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"> Menu <i class="fas fa-bars"></i> </button> 
    <div class="collapse navbar-collapse" id="navbarResponsive"> 
     <ul class="navbar-nav ml-auto"> 
      <li class="nav-item mx-0 mx-lg-1"> <a class="nav-link py-3 px-0 px-lg-3" href="/posts.html">博客文章</a> </li> 
      <li class="nav-item mx-0 mx-lg-1"> <a class="nav-link py-3 px-0 px-lg-3" href="/books.html">创作出版</a> </li> 
      <li class="nav-item mx-0 mx-lg-1"> <a class="nav-link py-3 px-0 px-lg-3" href="https://edu.afoo.me">福强AI学堂</a> </li> 
      <li class="nav-item mx-0 mx-lg-1"> <a class="nav-link py-3 px-0 px-lg-3" href="/crosslinks.html">更多链接</a> </li> 
      <li class="nav-item mx-0 mx-lg-1"> <a class="nav-link py-3 px-0 px-lg-3" href="/whoami.html">关于我</a> </li> 
      <li class="nav-item mx-0 mx-lg-1"> <a class="nav-link py-3 px-0 px-lg-3" href="/feeds.xml">RSS订阅</a> </li> 
     </ul> 
    </div> 
   </div> 
  </nav> 
  <section> 
   <div class="container"> <!--        <div class="row">--> <!--          <div class="col-lg-8 mx-auto">--> 
    <p class="lead"> </p>
    <h1 class="title">Git对非ASCII文件名的Octal Escape处理说明</h1> <small> <h3 class="author">王福强</h3> 
     <div style="text-align: left;"></div> </small> 
    <p></p> 
    <hr> 
    <p>在Mac上如果将文件命名为中文，当将这个文件<code>git add .</code>之后， 在<code>git st</code>中显示的文件名将类似于如下的形式：</p> 
    <pre>Wangs-MacBook-Pro:docworks fujohnwang$ git add .
Wangs-MacBook-Pro:docworks fujohnwang$ git st
# On branch master
# Changes to be committed:
#   (use "git reset HEAD <file>
      ..." to unstage)
#
#   modified:   worksheets/daily_todo.md
#   new file:   "worksheets/\345\205\263\351\224\256\350\257\215\345\272\223\345\273\272\350\256\276\350\257\264\346\230\216.md"

     </file></pre> 
    <p>之前对这种现象一直熟视无睹，今天“良心发现”，就抠了一下， 反正Google了一堆文档，简单总结下来是这样的： git会对Non-ASCII的文件名进行编码(如果本地编码是utf8, 那就用utf8进行编码)， 编码之后，将编码转变为octal escape形式显示，从而，就变成了上面所看到的那个样子。</p> 引用一下别人的说法，或许信息量更大一些: 
    <pre>You can git-add files with non-ASCII characters, but you can't sensibly work with
them as Git stores them as sequences of raw bytes in whatever codepage GetACP()
returns (cp1251 in your case). This is documented in git-show(1) for instance.

In general, this means you can only add non-ASCII filenames if you're sure no one
will ever clone your repo to a machine with different codepage/charset (on a Unix
box, for instance), as these filenames are recorded in a non-portable way.

Additional inconvenience is that some command-line Git tools (namely, git-log,
git-add and git-commit) show bytes above 0x7F in filenames using "octal escapes",
like this: "\346\356\357\340" (in other words, on displaying, filenames are
"normalized" to strict ASCII).

So, to sum this up:
1) Non-ASCII filenames are handled mostly OK, except for the output (`git-log
--name-status` shows octal-escaped names for instance).
2) The repository is non-portable.
</pre> 关于Octal Escape形式的Literal, Java里的定义是这样的： 
    <pre>OctalEscape:
    \ OctalDigit
    \ OctalDigit OctalDigit
    \ ZeroToThree OctalDigit OctalDigit

OctalDigit: one of
    0 1 2 3 4 5 6 7

ZeroToThree: one of
    0 1 2 3
</pre> 
    <p>简单来讲，就是范围是<code>\0-\377</code>, 换算到十进制是<code>0-255</code>。</p> 
    <p>不过Octal Escape算是C时代的遗老了，现在都加都倾向于utf8/unicode，比如<a href="http://www.marshut.com/munzm/any-interest-in-keeping-octal-escape-literals.html" class="uri">http://www.marshut.com/munzm/any-interest-in-keeping-octal-escape-literals.html</a>这里的倡议。</p> 
    <p>如果想在Octal Escape字面量与字符之间互转， 在Java里做可能还会有点儿小坑爹的， 除了要做2层转换(字面量到encoding的值，encoding的值到字符)， 还要注意char在java里的存储，怎么搞？ 感兴趣的话，看官自己去折腾折腾吧～</p> 
    <p>至于如何修正：</p> 
    <p><code>git config --global core.quotepath false</code></p> 
    <p>或者直接更改~/.gitconfig:</p> 
    <pre><code>[core]
    quotepath = false</code></pre> 
    <p><strong>参考链接</strong></p> 
    <ol type="1"> 
     <li><a href="https://code.google.com/p/msysgit/issues/detail?id=230">msysgit: Issue 230: Question: How I can add files in national character</a></li> 
     <li><a href="http://stackoverflow.com/questions/9543026/why-do-java-octal-escapes-only-go-up-to-255" class="uri">http://stackoverflow.com/questions/9543026/why-do-java-octal-escapes-only-go-up-to-255</a></li> 
     <li><a href="http://stackoverflow.com/questions/5581857/git-and-the-umlaut-problem-on-mac-os-x" class="uri">http://stackoverflow.com/questions/5581857/git-and-the-umlaut-problem-on-mac-os-x</a></li> 
     <li><a href="http://stackoverflow.com/questions/4144417/how-to-handle-asian-characters-in-file-names-in-git-on-os-x" class="uri">http://stackoverflow.com/questions/4144417/how-to-handle-asian-characters-in-file-names-in-git-on-os-x</a></li> 
    </ol> <!--          </div>--> <!--        </div>--> 
    <hr> 
    <div> <a href="/posts.html"> <b> &gt;&gt;&gt;&gt;&gt;&gt; 更多阅读 &lt;&lt;&lt;&lt;&lt;&lt; </b></a> 
    </div> 
    <div id="random_posts"> 
     <div class="alert alert-light" role="alert"> <a href="/posts/2009-10-21-thinking_in_how_to_improve_ROMA_framework.html">ROMA框架潜在改进点思考 </a> 
     </div> 
     <div class="alert alert-light" role="alert"> <a href="/posts/2013-04-23-anti-earthquake-design.html">门外汉谈建筑的抗震设计 </a> 
     </div> 
     <div class="alert alert-light" role="alert"> <a href="/posts/2009-05-04-some-words.html">那些话儿 </a> 
     </div> 
    </div> 
    <div id="comments"></div> 
    <hr> 
    <div> 
     <p> 「为AI疯狂」星球上，扶墙老师正在和朋友们讨论有趣的AI话题，你要不要⼀起来呀？^-^<br> 这里 </p>
     <ol> 
      <li>不但有及时新鲜的AI资讯和深度探讨</li> 
      <li>还分享AI工具、产品方法和商业机会</li> 
      <li>更有体系化精品付费内容等着你，<a href="https://t.zsxq.com/0dI3ZA0sL">加入星球(https://t.zsxq.com/0dI3ZA0sL)</a> 即可免费领取。(加入之后<b>一定记得看置顶消息</b>呀！)</li> 
     </ol> 
     <p></p> <a href="https://t.zsxq.com/0dI3ZA0sL"> <img src="/posts/images/2023-05-06-12-09-53.jpg" alt="知识星球二维码"> </a> 
    </div> 
    <hr> 
    <p> <span style="font-size: xx-large;">存量的时代，省钱就是赚钱。</span> <br> <span style="font-size: xx-large;">在增量的时代，省钱其实是亏钱。</span> <br> 避坑儿是省钱的一种形式，更是真正聪明人的选择！ <br> 弯路虽然也是路，但还是能少走就少走，背后都是高昂的试错成本。 <br> <b>订阅「福报」</b>，少踩坑，少走弯路，多走一步，就是不一样的胜率！ </p> <a href="https://wfq.gumroad.com/l/fb"> <img src="/images/fb_subscribe.jpg" alt="订阅「福报Premium订阅」"> </a> 
    <hr> 
    <div hx-get="https://toolfooter.afoo.me/" hx-trigger="revealed"></div> <!-- <div class="text-center">
      <a href="https://twitter.com/fujohnwang">
        <img src="/images/Twitter-logo.png" class="img-responsive" loading='lazy' style="width: fit-content;">
      </a>
    </div> --> 
   </div> 
  </section> 
  <div style="color:white; visibility: collapse; height: 0;">
   ©<a href="/whoami.html">王福强</a>个人版权所有, All Rights Reserved.
  </div> 
  <div class="copyright py-4 text-center text-white"> 
   <div class="container"> <small>Copyright © <a href="/whoami.html">王福强</a>个人版权所有 - Since 2004</small> 
    <br><small>Everything is homebrewed with <a href="https://pandoc.org/">pandoc</a> and <a href="https://daringfireball.net/projects/markdown/syntax">Markdown</a>, little <a href="https://www.scala-lang.org/">Scala</a> also included.</small> 
   </div> 
  </div> 
  <script type="text/javascript">
var gitalk = new Gitalk({
  clientID: '518a605d711883414ac0',
  clientSecret: '69fb8ccc0616c5bcbc64d24ece0d06d279da91ff',
  repo: 'afoo.me.comments',
  owner: 'fujohnwang',
  admin: ['fujohnwang'],
  id: location.pathname.substring(0, 49),      // Ensure uniqueness and length less than 50
  distractionFreeMode: false  // Facebook-like distraction free mode
})

gitalk.render('comments')
    </script> 
  <script src="https://storage.ko-fi.com/cdn/scripts/overlay-widget.js"></script> 
  <script>
  kofiWidgetOverlay.draw('fff000', {
    'type': 'floating-chat',
    'floating-chat.donateButton.text': 'Support me',
    'floating-chat.donateButton.background-color': 'red',
    'floating-chat.donateButton.text-color': 'white'
  });
</script>  <!-- <script>watermark.init({ watermark_txt: "©王福强个人版权所有, All Rights Reserved." , watermark_width:200})</script> --> 
 </body>
</html>