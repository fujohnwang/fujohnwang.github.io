% å¤§è¯­è¨€æ¨¡å‹çš„è¾“å‡ºé•¿åº¦ä¸ºå•¥éƒ½ä¸é•¿ï¼Ÿ
% ç‹ç¦å¼º
% 2025-02-15

aka. Why each LLM models' output length is short or NOT long enough?

å…¶å®æˆ‘ä¹Ÿåˆ†ä¸æ¸…æ¥šè¿™ä¸ªé—®é¢˜åˆ°åº•æ˜¯å¤ªåŸºç¡€äº†è¿˜æ˜¯å¤ªä¸“ä¸šäº†ï¼Œé—®äº†ä¸€åœˆï¼Œæœ‹å‹åœˆå°±æœ‰ä¸€ä¸ªAIè¡Œä¸šçš„åŒå­¦å“åº”ï¼Œä½†ä¹Ÿåªæ˜¯è¯´äº†ä¸€ä¸ªç‰¹å¾å’Œè§†è§’ï¼Œ æ‰€ä»¥ï¼Œä»Šå¤©å½»åº•è‡ªå·±åšäº†ä¸ªè°ƒç ”ï¼Œè°ƒç ”ç»“æœåˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¯å‘ã€åˆå¸®åŠ©ã€‚

ä¸ºä»€ä¹ˆæˆ‘ä¼šå…³å¿ƒè¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ

å› ä¸ºæˆ‘åœ¨å°†ä¸€ä¸ªå¤§æ–‡ä»¶æ‰”ç»™Geminiä¹‹åï¼ŒåŸæœ¬æœŸæœ›å®ƒç›´æ¥è¿”å›å¯¹åº”çš„å®Œæ•´ç¿»è¯‘ç»“æœç»™æˆ‘ï¼Œç»“æœå‘ç°ï¼Œç›´æ¥æˆªæ–­...

è¿™ä¸ªç»“æœç›´æ¥ç»™æˆ‘å¹²æ‡µäº†ï¼Œ Geminiä¸æ˜¯å£°ç§°ç™¾ä¸‡tokensä¸Šä¸‹æ–‡çª—å£å—ï¼Ÿ è¿™ç‚¹å„¿å†…å®¹æ˜æ˜¾è¾“å…¥+è¾“å‡ºçš„å†…å®¹ä¹Ÿä¸å¤Ÿå¡æ»¡çš„å‘€ï¼Ÿï¼

æˆ‘å°±æŸ¥çœ‹æ˜¯ä¸æ˜¯ä»€ä¹ˆåœ°æ–¹è®¾ç½®ä¸å¯¹ï¼Œç„¶åæ‰¾åˆ°äº†è¿™ä¸ªé…ç½®é¡¹ï¼ˆé»˜è®¤æŠ˜å çŠ¶æ€ï¼‰ï¼š

![](./images/aistudio-model-output-length.jpg)

ç„¶åæƒ³è°ƒé«˜å®ƒï¼Œå‘ç°è°ƒé«˜ä¸äº†ï¼Œæœ€é«˜å°±æ˜¯8192

è¿™tndå’‹å›äº‹ï¼Ÿ

å…ˆé—®äº†æœ‹å‹åœˆï¼Œå“åº”äº†äº†ï¼Œæ‰€ä»¥ï¼Œè‡ªå·±è°ƒç ”å§ï¼Œè‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿå˜›ï½

è°ƒç ”åå‘ç°ï¼Œä½ çŒœæ€ä¹ˆç€ï¼Ÿ å…¶å®å¤§å¤šæ•°å¸‚é¢ä¸Šæµè¡Œçš„å¤§è¯­è¨€æ¨¡å‹ï¼Œä»–ä»¬çš„è¾“å‡ºé•¿åº¦ï¼ˆoutput lengthæˆ–è€…å«max_output_tokensï¼‰éƒ½ä¸é•¿ï¼š

![](./images/llm-output-length-compare.jpg)

ä¸ä½†éƒ½ä¸é•¿ï¼Œè€Œä¸”ï¼Œè¾“å…¥å’Œè¾“å‡ºçš„tokensæ•°é‡æ˜¯æœ‰å·¨å¤§ä¸å¯¹ç§°æ€§çš„ã€‚

ä¸ºå•¥ä¼šå‡ºç°è¿™æ ·çš„æ™®éç°è±¡å‘¢ï¼Ÿ

ç»¼åˆè°ƒç ”ç»“æœï¼Œå¯ä»¥ä»äº§å“å’ŒæŠ€æœ¯ä¸¤ä¸ªå±‚é¢è¿›è¡Œè§£è¯»ï¼Œè¿™ä¸¤ä¸ªå±‚é¢åˆå¯ä»¥è¿›ä¸€æ­¥æ‹†åˆ†ï¼Œå½¢æˆå››ä¸ªç»´åº¦ï¼ˆå½“ç„¶å•¦ï¼Œè¿™å‡ ä¸ªç»´åº¦å’Œè§†è§’å±äºæˆ‘ä¸ªäººæ€»ç»“ï¼‰ï¼š

| äº§å“  | æŠ€æœ¯  | 
|:-------------: |:---------------:|
| cost | æ¨¡å‹è¯­æ–™é™åˆ¶ | 
| timeout | è¾¹ç•Œé—®é¢˜ | 

ä¸‹é¢è®©æˆ‘ä»¬å±•å¼€æ¥è¯¦ç»†è¯´ä¸‹...

## costï¼ˆäº§å“å±‚é¢ï¼‰

ä¹Ÿå°±æ˜¯ï¼Œè¾“å‡ºé•¿åº¦ï¼ˆoutput lengthæˆ–è€…å«max_output_tokensï¼‰æœ‰é™åˆ¶ï¼Œé¦–å…ˆæ˜¯ä¸€ä¸ªæˆæœ¬é—®é¢˜ï¼ˆcostï¼‰ã€‚

è¿™ä¸ªæˆæœ¬çš„æ¦‚å¿µä»ä¾›åº”æ–¹å’Œæ¶ˆè´¹è€…ä¸¤æ–¹é¢éƒ½æˆç«‹ï¼š

- ä½œä¸ºä¾›åº”ä¸€æ–¹ï¼Œ è¿‡é•¿çš„è¾“å‡ºé•¿åº¦æ„å‘³ç€æ›´å¤šçš„ç®—åŠ›æ¶ˆè€—
- ä½œä¸ºæ¶ˆè´¹è€…ï¼Œåœ¨äº§å“è®¾è®¡å±‚é¢å¦‚æœä¸åŠ è¾“å‡ºé•¿åº¦é™åˆ¶ï¼Œå¾ˆå®¹æ˜“è´¦å•è¶…é¢

è¾“å‡ºå¯¹åº”çš„æ˜¯å†…å®¹ç”Ÿæˆè¿™æ®µè¿‡ç¨‹ï¼Œç”Ÿæˆé•¿åº¦è¶Šé•¿ï¼Œç®—åŠ›æ¶ˆè€—è¶ŠæˆæŒ‡æ•°çº§æš´æ¶¨ï¼Œåè€Œè¾“å…¥é˜¶æ®µæ²¡æœ‰è¿™ä¹ˆå¤¸å¼ ã€‚ è¿™æœ‰ç‚¹å„¿è·Ÿä¼ ç»Ÿè®¡ç®—æœºç³»ç»Ÿé‡Œçš„è¯»å’Œå†™çš„æ¦‚å¿µï¼Œ åœ¨ä¼ ç»Ÿè®¡ç®—æœºç³»ç»Ÿé‡Œï¼Œè¯»çš„æˆæœ¬å…¶å®ä¸é«˜ï¼Œå°¤å…¶åŠ ç¼“å­˜ï¼ˆCacheï¼‰ä¹‹åï¼Œå†™çš„æˆæœ¬å¾ˆå¤šæ—¶å€™åè€Œä¼šé«˜ï¼Œå¦‚æœä½ æ˜¯åšæŠ€æœ¯å‡ºèº«çš„ï¼ˆä½†ä¸æ˜¯åšæ¨¡å‹å’Œç®—æ³•çš„ï¼‰ï¼Œè¿™æ ·ç±»æ¯”ï¼Œæˆ–è®¸æ›´å®¹æ˜“ç†è§£äº›å§ï¼

## timeoutï¼ˆäº§å“å±‚é¢ï¼‰

å¦‚æœå¤§æ¨¡å‹æ‰˜ç®¡åˆ°äº‘ä¸Šå¯¹å¤–æä¾›æœåŠ¡ï¼Œè®¿é—®ä¸€æ–¹è‚¯å®šä¸å¸Œæœ›é•¿æ—¶é—´çš„ç­‰å¾…ï¼Œç›¸å¯¹çŸ­å‘¨æœŸçš„åé¦ˆï¼Œä»äº§å“è®¾è®¡å±‚é¢æ¥è¯´ï¼Œå¯¹ç”¨æˆ·ä½“éªŒæ¥è¯´å¾ˆé‡è¦ã€‚

è€Œè¿‡é•¿çš„è¾“å‡ºï¼Œä¸ä½†éœ€è¦æ¶ˆè€—æ›´å¤šç®—åŠ›ï¼Œè¿˜ä¼šæ‹‰é•¿å“åº”å®Œæ•´å†…å®¹çš„æ—¶é—´ã€‚

ä½ ä¹Ÿä¸å¸Œæœ›ç”¨æˆ·åŸæœ¬æœŸç›¼çš„ç§’çº§å“åº”ï¼Œå˜æˆåˆ†é’Ÿçº§ç­‰å¾…å§ï¼Ÿ ï¼ˆå½“ç„¶ï¼ŒDeep Researchç±»äº§å“é™¤å¤–ï¼Œä»–ä»¬å¯ä»¥é€šè¿‡å¼‚æ­¥é€šçŸ¥çš„æ–¹å¼æ”¹å–„äº§å“ä½“éªŒï¼‰

æ‰€ä»¥ï¼Œè®¾ç½®ä¸€ä¸ªçŸ­çš„è¾“å‡ºé•¿åº¦é…ç½®ï¼Œå¯¹äºæ”¹å–„å“åº”æ—¶å»¶ï¼ˆlatencyï¼‰æ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰é¡¹ï¼Œæ€»æ¯”APIè°ƒç”¨è¶…æ—¶å¼ºå§ï¼Ÿ

## æ¨¡å‹è¯­æ–™é™åˆ¶ï¼ˆæŠ€æœ¯å±‚é¢ï¼‰

å¾ˆå°‘æ¨¡å‹ä¼šé’ˆå¯¹é•¿è¾“å‡ºè¿›è¡Œè®­ç»ƒï¼Œæ¨¡å‹ä¹Ÿä¼šæ¨¡ä»¿è¯­æ–™çš„ä¾‹å­ï¼Œæ¯”å¦‚é€šå¸¸è¯­æ–™ä¸­çš„ä¾‹å­å¤šé•¿ï¼Œå®ƒä¹Ÿè¾“å‡ºå¤šé•¿ã€‚

è¿™å°±å¯¼è‡´è¯´ï¼Œå°±ç®—ä½ æƒ³è¾“å‡ºæ›´é•¿çš„å†…å®¹ï¼Œå®ƒçš„è¾“å‡ºçª—å£ä¹Ÿå¤Ÿé•¿ï¼Œå‡å¦‚æ¨¡å‹å—é™äºè®­ç»ƒæ—¶å€™ç”¨çš„è¯­æ–™ï¼Œé‚£ä¹ˆï¼Œä»–å°±ä¼šè¿›å…¥å¾ªç¯è¾“å‡ºæ¨¡å¼ï¼Œ è¿™ä¹Ÿæ˜¯æœ‹å‹åœˆå­Ÿã•ã‚“æåˆ°çš„ç°è±¡ã€‚

## è¾¹ç•Œé—®é¢˜ï¼ˆæŠ€æœ¯å±‚é¢ï¼‰

å¤§è¯­è¨€æ¨¡å‹ä¸åƒäººä¸€æ ·å¯ä»¥ç›´è§‚åˆ¤æ–­ä»€ä¹ˆæ—¶å€™åº”è¯¥åœä¸‹ï¼Œæ‰€ä»¥ï¼Œè®¾ç½®ä¸€ä¸ªæ˜ç¡®çš„è¾“å‡ºé•¿åº¦å¯ä»¥å¸®åŠ©å®ƒå†³å®šä»€ä¹ˆæ—¶å€™å¯ä»¥åœä¸‹ã€‚

## æ€ä¹ˆåŠï¼Ÿ

æ—¢ç„¶é™åˆ¶åœ¨è¿™é‡Œï¼Œé‚£ä¹ˆï¼Œé‡åˆ°éœ€è¦è¶…è¿‡è¾“å‡ºé•¿åº¦(output length)çš„è¾“å‡ºå†…å®¹åº”è¯¥æ€ä¹ˆåŠï¼Ÿ

è‡³å°‘æœ‰ä¸‰ç§æ–¹å¼ï¼š

1. æˆ‘ä»¬å¯ä»¥é€šè¿‡èŠå¤©æ¥å£è·Ÿæ¨¡å‹promptï¼š `go on`æˆ–è€…`continue`ï¼Œ å®ƒä»¬é€šå¸¸å°±ä¼šç»§ç»­è¾“å‡ºï¼Œæˆ‘åœ¨aistudioä¸­å°±æ˜¯è¿™æ ·å®Œæˆä¸€ä¸ªé•¿æ–‡ä»¶çš„è¾“å‡ºæ±‡æ€»çš„ã€‚
2. é¢„å…ˆå¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œåˆ†æ®µå¤„ç†ï¼ˆchunkï¼‰ï¼Œç„¶ååœ¨ä¸€æ®µä¸€æ®µçš„äº¤ç»™å¤§è¯­è¨€æ¨¡å‹å»å¤„ç†ï¼Œåæ¥æˆ‘æŠŠé•¿æ–‡ä»¶å¤„ç†é€»è¾‘å›ºåŒ–ä¹‹åï¼Œå°±æ˜¯è¿™æ ·å¤„ç†çš„ï¼Œå½“æ—¶ä¹Ÿæ’‚ä¸‹ä¸€å¥â€œ**å¤§è¯­è¨€æ¨¡å‹åº”ç”¨çš„æ„å»ºè¿˜æ˜¯éœ€è¦å¾ˆå¤šå¤–å›´çš„curate**â€
3. ä½†ä¹Ÿä¸æ˜¯æ‰€æœ‰è¾“å…¥è¯­æ–™éƒ½å¯ä»¥åˆ†æ®µå¤„ç†ï¼Œå› ä¸ºå¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å¤§è¯­è¨€æ¨¡å‹å¯ä»¥é¢„å…ˆæ•´ä½“è¿‡ä¸€éï¼Œäº†è§£æ•´ä½“æ¦‚å†µï¼Œç„¶åå†åšå…·ä½“å·¥ä½œï¼Œåˆ†æ®µçš„åšæ³•å°±æ²¡æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å¤šæ¬¡è¾“å‡ºçš„å†…å®¹è¿½åŠ åˆ°ä¸‹ä¸€æ¬¡çš„è¾“å…¥å†…å®¹åé¢ï¼Œç„¶åå¤šæ¬¡æ‰§è¡Œå°±å¯ä»¥äº†ã€‚ è¿™æ ·åšçš„åˆç†ä¹‹å¤„åœ¨äºï¼Œå¤§è¯­è¨€æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£åœ¨è¾“å…¥ç«¯é€šå¸¸æ˜¯æ²¡æœ‰è¿‡å¤šé™åˆ¶çš„ï¼Œæ‰€ä»¥ï¼Œå°†æ¯æ¬¡è¾“å‡ºçš„çŸ­å†…å®¹é™„åŠ åˆ°ä¸‹ä¸€æ¬¡è¾“å…¥å†…å®¹åé¢å½¢æˆå®Œæ•´ä¸Šä¸‹æ–‡ï¼Œä¹Ÿå¯ä»¥æŒç»­å¤šæ¬¡è·å¾—å®Œæ•´è¾“å‡ºï¼Œæœ€ååšä¸ªæ±‡æ€»å°±å¯ä»¥äº†ï¼ˆmerge or joinï¼‰ã€‚

> NOTE
>
> è¶…é•¿çš„è¾“å…¥ä¸Šä¸‹æ–‡è·Ÿç›¸å¯¹è¾ƒçŸ­çš„è¾“å‡ºé•¿åº¦ï¼Œå½¢æˆäº†å¼ºçƒˆçš„å¯¹æ¯”ï¼Œæœ‰æ—¶å€™ä¸ç¦åœ¨æƒ³ï¼Œå„ä¸ªå¤§è¯­è¨€æ¨¡å‹å‚å•†éƒ½å·ç§°â€œè¶…é•¿ä¸Šä¸‹æ–‡çª—å£â€æˆ–è®¸æ›´å¤šæ˜¯ä¸ºäº†è¥é”€å™±å¤´ï¼Œä¸åšç»“æ„æ‹†è§£ï¼Œåæ­£ä¹Ÿä¸èƒ½è¯´äººå®¶ä¸å¯¹ğŸ¤£

## å‚è€ƒé“¾æ¥

- ttps://www.reddit.com/r/LocalLLaMA/comments/1f3s0qc/why_do_llms_have_output_limit/
- https://medium.com/@techsachin/longwriter-using-llm-agent-based-pipeline-to-scale-llms-output-window-size-to-10-000-words-33210d299e2b
- https://medium.com/@rakesharma21/maximizing-output-in-large-language-models-beyond-token-limits-7931952e664c
- [How to handle responses that donâ€™t fit in the 4096 token maximum output size](https://community.openai.com/t/how-to-handle-responses-that-dont-fit-in-the-4096-token-maximum-output-size/864449)
- [Context Length in LLMs: What Is It and Why It Is Important](https://datanorth.ai/blog/context-length)
- https://www.vellum.ai/llm-parameters/max-tokens // è¿™ä¸ªç½‘ç«™ä¸é”™ï¼Œæœ‰å¾ˆå¤šLLMå‚æ•°çš„è§£é‡Š
- https://www.taivo.ai/__llm-latency-is-linear-in-output-token-count/






